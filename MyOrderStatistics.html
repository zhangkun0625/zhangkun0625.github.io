<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>多产品销售数据记录</title>
    <style>
      body {
        font-family: Arial, sans-serif;
      }
      table,
      th,
      td {
        border: 1px solid black;
        border-collapse: collapse;
      }
      th,
      td {
        padding: 5px;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h2>产品销售数据输入</h2>
    <form id="dataForm">
      日期: <input type="date" id="date" /><br />
      15寸订单量: <input type="number" id="product15OrderQty" /> 销售数:
      <input type="number" id="product15SalesQty" /><br />
      18寸订单量: <input type="number" id="product18OrderQty" /> 销售数:
      <input type="number" id="product18SalesQty" /><br />
      4x10订单量: <input type="number" id="product4x10OrderQty" /> 销售数:
      <input type="number" id="product4x10SalesQty" /><br />
      <button type="button" onclick="addData()">添加数据</button>
    </form>

    <button onclick="clearAllData()">清除所有数据</button>

    <h2>产品销售数据表格</h2>
    <table id="data-table">
      <thead>
        <tr>
          <th>日期</th>
          <th>15寸订单量</th>
          <th>15寸销售数</th>
          <th>18寸订单量</th>
          <th>18寸销售数</th>
          <th>4x10订单量</th>
          <th>4x10销售数</th>
          <th>15寸订单总量</th>
          <th>15寸销售总数</th>
          <th>18寸订单总量</th>
          <th>18寸销售总数</th>
          <th>4x10订单总量</th>
          <th>4x10销售总数</th>
        </tr>
      </thead>
      <tbody>
        <!-- 数据行将被动态添加到此处 -->
      </tbody>
    </table>

    <script>
      // 存储数据的数组
      let salesData = [];

      // 从本地存储加载数据
      window.onload = function () {
        if (localStorage.salesData) {
          salesData = JSON.parse(localStorage.getItem('salesData'));
          renderTable();
        }
      };

      // 保存数据到本地存储
      function saveData() {
        localStorage.setItem('salesData', JSON.stringify(salesData));
      }

      // 添加数据到表格
      function addData() {
        // 收集输入数据
        let date = document.getElementById('date').value;
        let product15OrderQty = parseInt(
          document.getElementById('product15OrderQty').value,
          10
        );
        let product15SalesQty = parseInt(
          document.getElementById('product15SalesQty').value,
          10
        );
        let product18OrderQty = parseInt(
          document.getElementById('product18OrderQty').value,
          10
        );
        let product18SalesQty = parseInt(
          document.getElementById('product18SalesQty').value,
          10
        );
        let product4x10OrderQty = parseInt(
          document.getElementById('product4x10OrderQty').value,
          10
        );
        let product4x10SalesQty = parseInt(
          document.getElementById('product4x10SalesQty').value,
          10
        );

        // 计算订单总量和销售总数
        let totals = calculateTotals();
        salesData.push({
          date: date,
          orderQuantity15: product15OrderQty,
          salesQuantity15: product15SalesQty,
          orderQuantity18: product18OrderQty,
          salesQuantity18: product18SalesQty,
          orderQuantity4x10: product4x10OrderQty,
          salesQuantity4x10: product4x10SalesQty,
          ...totals,
        });

        // 清空输入框
        clearInputs();

        // 渲染表格并保存数据
        renderTable();
        saveData();
      }

      // 计算订单总量和销售总数
      function calculateTotals() {
        let lastEntry =
          salesData.length > 0
            ? salesData[salesData.length - 1]
            : {
                totalOrders15: 0,
                totalSales15: 0,
                totalOrders18: 0,
                totalSales18: 0,
                totalOrders4x10: 0,
                totalSales4x10: 0,
              };
        return {
          totalOrders15:
            lastEntry.totalOrders15 +
            (document.getElementById('product15OrderQty').valueAsNumber || 0),
          totalSales15:
            lastEntry.totalSales15 +
            (document.getElementById('product15SalesQty').valueAsNumber || 0),
          totalOrders18:
            lastEntry.totalOrders18 +
            (document.getElementById('product18OrderQty').valueAsNumber || 0),
          totalSales18:
            lastEntry.totalSales18 +
            (document.getElementById('product18SalesQty').valueAsNumber || 0),
          totalOrders4x10:
            lastEntry.totalOrders4x10 +
            (document.getElementById('product4x10OrderQty').valueAsNumber || 0),
          totalSales4x10:
            lastEntry.totalSales4x10 +
            (document.getElementById('product4x10SalesQty').valueAsNumber || 0),
        };
      }

      // 清除所有数据和本地存储
      function clearAllData() {
        salesData = [];
        localStorage.removeItem('salesData');
        renderTable();
        clearInputs();
      }

      // 清空输入框
      function clearInputs() {
        document.getElementById('date').value = '';
        document.getElementById('product15OrderQty').value = '';
        document.getElementById('product15SalesQty').value = '';
        document.getElementById('product18OrderQty').value = '';
        document.getElementById('product18SalesQty').value = '';
        document.getElementById('product4x10OrderQty').value = '';
        document.getElementById('product4x10SalesQty').value = '';
      }

      // 渲染表格
      function renderTable() {
        const tableBody = document
          .getElementById('data-table')
          .getElementsByTagName('tbody')[0];
        tableBody.innerHTML = ''; // 清空表格

        salesData.forEach((entry) => {
          const row = tableBody.insertRow();
          const cells = [
            entry.date,
            entry.orderQuantity15,
            entry.salesQuantity15,
            entry.orderQuantity18,
            entry.salesQuantity18,
            entry.orderQuantity4x10,
            entry.salesQuantity4x10,
            entry.totalOrders15,
            entry.totalSales15,
            entry.totalOrders18,
            entry.totalSales18,
            entry.totalOrders4x10,
            entry.totalSales4x10,
          ];
          cells.forEach((text) => {
            const cell = row.insertCell();
            cell.textContent = text;
          });
        });
      }

      // 初始化表格渲染
      window.onload = function () {
        renderTable();
      };
    </script>
  </body>
</html>
